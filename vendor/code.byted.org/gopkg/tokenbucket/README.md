# 令牌桶算法

## Go语言令牌桶算法包

令牌桶算法主要用于web网站的访问频率控制，应对外界对网站的恶意访问攻击，其基本思想如下，每个用户有一个桶，桶里面装着令牌，用户没访问一次就从桶里面取走一张令牌。当桶里面没有令牌的时候，就认为该用户访问超过限制了。同时另外一个程序会以一定的速度往桶里面扔令牌。这个速度就决定了用户正常访问网站的最大频率。

令牌桶算法对于特征集中的web服务是有效的。所谓特性集中就是多台web服务器上，统一特性的请求只会打到同一台服务器上。否则简单的令牌桶算法会失效。



## 例子


     // 创建一个总容量为20万的缓存区，限制速度为3次/每秒，允许瞬间访问频率为5次/每秒。
     RateLimiter = tokenbucket.New(200000, 3, 5)

     // 使用uid作为用户访问的特征，没访问一次，调用一次Consume方法，如果返回true，则表示此次访问正常，如果返回false，则表示此次访问超过限制。
     ok = RateLimiter.Consume(uid)
     if ok {
         // normal
     } else {
         // black
     }


